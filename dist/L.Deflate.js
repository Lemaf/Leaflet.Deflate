L.Deflate=function(o){function r(o,r){var e=o.getBounds(),a=i.project(e.getNorthEast(),r),n=i.project(e.getSouthWest(),r),t=a.x-n.x;return n.y-a.y<m||t<m}function e(o){var e=null,a=i.getZoom();if(r(o,i.getZoom()))for(;!e;)r(o,a+=1)||(e=a-1);else for(;!e;)r(o,a-=1)&&(e=a);return e}function a(r){var a=r.layer;if(!a._layers&&a.getBounds&&!a.zoomThreshold&&!a.marker){var n=e(a);if(o.icon&&o.markerColor)var m=L.VectorMarkers.icon({markerColor:o.markerColor,iconColor:o.iconColor?o.iconColor:"#000000",icon:o.icon});var c=L.marker(a.getBounds().getCenter(),{icon:m});a._popupHandlersAdded&&c.bindPopup(a._popup._content);var u=a._events;for(var r in u)if(u.hasOwnProperty(r))for(var l=u[r],s=0,f=l.length;s<f;s++)c.on(r,l[s].fn);c.options=a.options,a.zoomThreshold=n,a.marker=c,i.getZoom()<=n&&(t.removeLayer(a),t.addLayer(a.marker),d.push(a))}}function n(){t!==i&&i.removeLayer(t);var o=[];t.eachLayer(function(r){i.getZoom()<=r.zoomThreshold&&(t.removeLayer(r),t.addLayer(r.marker),o.push(r))});for(var r=0;r<d.length;r++){var e=d[r];i.getZoom()>e.zoomThreshold&&(t.removeLayer(e.marker),t.addLayer(e),d.splice(r,1),r-=1)}t!==i&&i.addLayer(t),d=d.concat(o)}var t,i,d=[],m=o.minSize||10;return{addTo:function(r){t=o.featureGroup||r,i=r,t.on("layeradd",a),i.on("zoomend",n)}}};