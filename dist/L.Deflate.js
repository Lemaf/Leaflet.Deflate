L.Deflate=function(r){function o(r,o){var e=r.getBounds(),a=d.project(e.getNorthEast(),o),n=d.project(e.getSouthWest(),o),t=a.x-n.x;return n.y-a.y<m||t<m}function e(r){var e=null,a=d.getZoom();if(o(r,d.getZoom()))for(;!e;)o(r,a+=1)||(e=a-1);else for(;!e;)o(r,a-=1)&&(e=a);return e}function a(o){var a=o.layer;if(!a._layers&&a.getBounds&&!a.zoomThreshold&&!a.marker){var n=e(a);if(r.icon&&r.markerColor)var m=L.VectorMarkers.icon({markerColor:r.markerColor,iconColor:r.iconColor?r.iconColor:"#000000",icon:r.icon});var c=L.marker(a.getBounds().getCenter(),{icon:m});a._popupHandlersAdded&&c.bindPopup(a._popup._content);var u=a._events;for(var o in u)if(u.hasOwnProperty(o))for(var l=u[o],f=0,s=l.length;f<s;f++)c.on(o,l[f].fn);a.zoomThreshold=n,a.marker=c,d.getZoom()<=n&&(t.removeLayer(a),t.addLayer(a.marker),i.push(a))}}function n(){t!==d&&d.removeLayer(t);var r=[];t.eachLayer(function(o){d.getZoom()<=o.zoomThreshold&&(t.removeLayer(o),t.addLayer(o.marker),r.push(o))});for(var o=0;o<i.length;o++){var e=i[o];d.getZoom()>e.zoomThreshold&&(t.removeLayer(e.marker),t.addLayer(e),i.splice(o,1),o-=1)}t!==d&&d.addLayer(t),i=i.concat(r)}var t,d,i=[],m=r.minSize||10;return{addTo:function(o){t=r.featureGroup||o,d=o,t.on("layeradd",a),d.on("zoomend",n)}}};