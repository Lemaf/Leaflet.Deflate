L.Deflate=function(e,r){function o(r,o){var a=r.getBounds(),t=e.project(a.getNorthEast(),o),m=e.project(a.getSouthWest(),o),d=t.x-m.x,u=m.y-t.y;return n>u||n>d}function a(r){var a=null,t=e.getZoom();if(o(r,e.getZoom()))for(;!a;)t+=1,o(r,t)||(a=t-1);else for(;!a;)t-=1,o(r,t)&&(a=t);return a}var t=[],n=r.minSize||10;e.on("layeradd",function(r){var o=r.layer;if(!o._layers&&o.getBounds&&!o.zoomThreshold&&!o.marker){var n=a(o),m=L.marker(o.getBounds().getCenter());o.zoomThreshold=n,o.marker=m,e.getZoom()<=n&&(e.removeLayer(o),e.addLayer(o.marker),t.push(o))}}),e.on("zoomend",function(){var r=[];e.eachLayer(function(o){e.getZoom()<=o.zoomThreshold&&(e.removeLayer(o),e.addLayer(o.marker),r.push(o))});for(var o=0;o<t.length;o++){var a=t[o];e.getZoom()>a.zoomThreshold&&(e.removeLayer(a.marker),e.addLayer(a),t.splice(o,1),o-=1)}t=t.concat(r)})};